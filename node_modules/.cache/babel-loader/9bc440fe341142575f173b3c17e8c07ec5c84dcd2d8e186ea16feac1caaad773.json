{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\n\n//From these options we can manage how to get the user location\n//If enableHighAccuracy is true it returns the user location more accurate.\n//maximumAge is a option that controls how to get the location from the cache.(0 means that we won't take the location from cache).\nconst OPTIONS = {\n  enableHighAccuracy: true,\n  maximumAge: 0\n};\nconst useMyLocation = () => {\n  _s();\n  const [locationInfo, setLocationInfo] = useState({\n    lon: 0,\n    lat: 0,\n    accuracy: 0\n  });\n  const [error, setError] = useState({\n    message: \"\"\n  });\n  const [loading, setLoading] = useState(false);\n\n  //Update states if the geolocation info is returned successfully\n  const onSuccess = position => {\n    const freshLon = position.coords.longitude;\n    const freshLat = position.coords.latitude;\n    const accuracy = position.coords.accuracy;\n\n    //If the coordinates are changed update them\n    if (freshLon !== (locationInfo === null || locationInfo === void 0 ? void 0 : locationInfo.lon) || freshLat !== (locationInfo === null || locationInfo === void 0 ? void 0 : locationInfo.lat)) {\n      setLocationInfo({\n        lon: freshLon,\n        lat: freshLat,\n        accuracy\n      });\n    }\n    setLoading(false);\n  };\n  const onError = error => {\n    setError(error);\n    setLoading(false);\n  };\n  useEffect(() => {\n    try {\n      //Check if the browser supports geolocation\n      if (navigator.geolocation) {\n        setLoading(true);\n\n        //watchPosition returns the user location when the device location is changed\n        const watcherId = navigator.geolocation.watchPosition(onSuccess, onError, OPTIONS);\n        return () => {\n          console.log(\"OUT: \");\n          navigator.geolocation.clearWatch(watcherId);\n        };\n      } else {\n        throw new Error(\"Geolocation is not supported by this browser.\");\n      }\n    } catch (error) {\n      setError(error);\n      setLoading(false);\n    }\n  }, []);\n  return {\n    locationInfo,\n    error,\n    loading\n  };\n};\n_s(useMyLocation, \"v4rG25MNz1AO0NV3+ZSOlN/T26w=\");\nexport default useMyLocation;","map":{"version":3,"names":["useEffect","useState","OPTIONS","enableHighAccuracy","maximumAge","useMyLocation","_s","locationInfo","setLocationInfo","lon","lat","accuracy","error","setError","message","loading","setLoading","onSuccess","position","freshLon","coords","longitude","freshLat","latitude","onError","navigator","geolocation","watcherId","watchPosition","console","log","clearWatch","Error"],"sources":["/Users/nikolayvalkov/work/my-location/src/hooks/useMyLocation.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\n\n//From these options we can manage how to get the user location\n//If enableHighAccuracy is true it returns the user location more accurate.\n//maximumAge is a option that controls how to get the location from the cache.(0 means that we won't take the location from cache).\nconst OPTIONS = { enableHighAccuracy: true, maximumAge: 0 };\n\nconst useMyLocation = () => {\n\tconst [locationInfo, setLocationInfo] = useState({\n\t\tlon: 0,\n\t\tlat: 0,\n\t\taccuracy: 0,\n\t});\n\tconst [error, setError] = useState({ message: \"\" });\n\tconst [loading, setLoading] = useState(false);\n\n\t//Update states if the geolocation info is returned successfully\n\tconst onSuccess = (position) => {\n\t\tconst freshLon = position.coords.longitude;\n\t\tconst freshLat = position.coords.latitude;\n\t\tconst accuracy = position.coords.accuracy;\n\n\t\t//If the coordinates are changed update them\n\t\tif (freshLon !== locationInfo?.lon || freshLat !== locationInfo?.lat) {\n\t\t\tsetLocationInfo({ lon: freshLon, lat: freshLat, accuracy });\n\t\t}\n\t\tsetLoading(false);\n\t};\n\n\tconst onError = (error) => {\n\t\tsetError(error);\n\t\tsetLoading(false);\n\t};\n\n\tuseEffect(() => {\n\t\ttry {\n\t\t\t//Check if the browser supports geolocation\n\t\t\tif (navigator.geolocation) {\n\t\t\t\tsetLoading(true);\n\n\t\t\t\t//watchPosition returns the user location when the device location is changed\n\t\t\t\tconst watcherId = navigator.geolocation.watchPosition(\n\t\t\t\t\tonSuccess,\n\t\t\t\t\tonError,\n\t\t\t\t\tOPTIONS\n\t\t\t\t);\n\n\t\t\t\treturn () => {\n\t\t\t\t\tconsole.log(\"OUT: \");\n\t\t\t\t\tnavigator.geolocation.clearWatch(watcherId);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t\"Geolocation is not supported by this browser.\"\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tsetError(error);\n\t\t\tsetLoading(false);\n\t\t}\n\t}, []);\n\n\treturn {\n\t\tlocationInfo,\n\t\terror,\n\t\tloading,\n\t};\n};\n\nexport default useMyLocation;\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;;AAE3C;AACA;AACA;AACA,MAAMC,OAAO,GAAG;EAAEC,kBAAkB,EAAE,IAAI;EAAEC,UAAU,EAAE;AAAE,CAAC;AAE3D,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC3B,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGP,QAAQ,CAAC;IAChDQ,GAAG,EAAE,CAAC;IACNC,GAAG,EAAE,CAAC;IACNC,QAAQ,EAAE;EACX,CAAC,CAAC;EACF,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC;IAAEa,OAAO,EAAE;EAAG,CAAC,CAAC;EACnD,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;;EAE7C;EACA,MAAMgB,SAAS,GAAIC,QAAQ,IAAK;IAC/B,MAAMC,QAAQ,GAAGD,QAAQ,CAACE,MAAM,CAACC,SAAS;IAC1C,MAAMC,QAAQ,GAAGJ,QAAQ,CAACE,MAAM,CAACG,QAAQ;IACzC,MAAMZ,QAAQ,GAAGO,QAAQ,CAACE,MAAM,CAACT,QAAQ;;IAEzC;IACA,IAAIQ,QAAQ,MAAKZ,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEE,GAAG,KAAIa,QAAQ,MAAKf,YAAY,aAAZA,YAAY,uBAAZA,YAAY,CAAEG,GAAG,GAAE;MACrEF,eAAe,CAAC;QAAEC,GAAG,EAAEU,QAAQ;QAAET,GAAG,EAAEY,QAAQ;QAAEX;MAAS,CAAC,CAAC;IAC5D;IACAK,UAAU,CAAC,KAAK,CAAC;EAClB,CAAC;EAED,MAAMQ,OAAO,GAAIZ,KAAK,IAAK;IAC1BC,QAAQ,CAACD,KAAK,CAAC;IACfI,UAAU,CAAC,KAAK,CAAC;EAClB,CAAC;EAEDhB,SAAS,CAAC,MAAM;IACf,IAAI;MACH;MACA,IAAIyB,SAAS,CAACC,WAAW,EAAE;QAC1BV,UAAU,CAAC,IAAI,CAAC;;QAEhB;QACA,MAAMW,SAAS,GAAGF,SAAS,CAACC,WAAW,CAACE,aAAa,CACpDX,SAAS,EACTO,OAAO,EACPtB,OACD,CAAC;QAED,OAAO,MAAM;UACZ2B,OAAO,CAACC,GAAG,CAAC,OAAO,CAAC;UACpBL,SAAS,CAACC,WAAW,CAACK,UAAU,CAACJ,SAAS,CAAC;QAC5C,CAAC;MACF,CAAC,MAAM;QACN,MAAM,IAAIK,KAAK,CACd,+CACD,CAAC;MACF;IACD,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACfC,QAAQ,CAACD,KAAK,CAAC;MACfI,UAAU,CAAC,KAAK,CAAC;IAClB;EACD,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IACNT,YAAY;IACZK,KAAK;IACLG;EACD,CAAC;AACF,CAAC;AAACT,EAAA,CA5DID,aAAa;AA8DnB,eAAeA,aAAa"},"metadata":{},"sourceType":"module","externalDependencies":[]}